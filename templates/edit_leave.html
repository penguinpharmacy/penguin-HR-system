<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ leave_type }} 紀錄編輯</title>
  <link href="/static/style.css" rel="stylesheet">
</head>
<body class="p-4">
  <h1 class="text-2xl mb-4">{{ leave_type }} 紀錄編輯</h1>
  <a href="{{ url_for('leave_history', emp_id=emp_id, leave_type=leave_type) }}"
     class="text-blue-600 mb-4 inline-block">← 返回紀錄</a>

  <form action="{{ url_for('edit_leave_record',
                           emp_id=emp_id,
                           leave_type=leave_type,
                           record_id=record_id) }}"
        method="post"
        class="space-y-4">
    <div>
      <label>開始日期：
        <input type="date" name="start_date" value="{{ start_date }}" required class="border px-2 py-1">
      </label>
    </div>
    <div>
      <label>結束日期：
        <input type="date" name="end_date" value="{{ end_date }}" required class="border px-2 py-1">
      </label>
    </div>
    <div>
      <label>時數（小時，最小 0.5）：
        <input type="number"
               name="hours"
               step="0.5"
               min="0.5"
               value="{{ hours if hours is defined else ((days or 0) * 8) }}"
               required class="border px-2 py-1 w-32">
      </label>
      <div class="text-sm text-gray-600 mt-1">（原本的「天數」已改為「小時」，例如 1 天 = 8 小時）</div>
    </div>
    <div>
      <label>備註：
        <input type="text" name="note" value="{{ note }}" class="border px-2 py-1 w-full">
      </label>
    </div>

    <!-- 🔽 新增：到期與提醒區塊（不影響原有欄位） -->
    <div class="border rounded p-4 bg-gray-50 mt-4">
      <div class="font-semibold mb-2">到期與提醒</div>
      <div class="text-sm text-gray-700 mb-2">
        制度：<b>{{ policy_name }}</b>　
        提醒視窗：<b>{{ reminder_window_days }}</b> 天
      </div>

      <div>
        <label>最終到期日：
          <input type="date" value="{{ expiry_date or '' }}" readonly class="border px-2 py-1 bg-gray-100">
        </label>
      </div>
      <div>
        <label>距到期剩餘天數：
          <input type="text" value="{{ days_to_expiry if days_to_expiry is not none else '' }}"
                 readonly class="border px-2 py-1 bg-gray-100 w-24">
        </label>
      </div>
    </div>
    <!-- 🔼 新增結束 -->

    <div>
      <button type="submit" class="px-4 py-2 bg-blue-500 text-white rounded">儲存修改</button>
      <a href="{{ url_for('leave_history', emp_id=emp_id, leave_type=leave_type) }}"
         class="ml-4 text-gray-600">取消</a>
    </div>
  </form>
</body>
</html>
