<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>編輯員工</title>
  <link href="/static/style.css" rel="stylesheet">
</head>
<body class="p-4">
  <h1 class="text-2xl mb-4">編輯員工</h1>

  <!-- 說明：特休已改用「小時」，1 天 = 8 小時 -->
  <div class="mb-4 text-sm text-gray-600">提示：特休以「小時」計算；1 天 = 8 小時；調整欄位可填正負，0.5 小時為單位。</div>

  <form action="/edit/{{ emp[0] }}" method="post" class="space-y-4">
    <!-- 分店 -->
    <div>
      <label class="block">分店：
        <select name="branch" class="border px-2 py-1 w-full" required>
          <option value="penguin_pharmacy" {% if emp[15] == 'penguin_pharmacy' %}selected{% endif %}>企鵝藥局</option>
          <option value="penguin_health" {% if emp[15] == 'penguin_health' %}selected{% endif %}>企鵝藥妝</option>
          <!-- 之後有新分店再加 -->
        </select>
      </label>
    </div>

    <!-- 基本資料 -->
    <div>
      <label class="block">姓名：
        <input type="text" name="name" value="{{ emp[1] }}" required class="border px-2 py-1 w-full">
      </label>
    </div>

    <!-- 到職／離職 -->
    <div>
      <label class="block">到職日：
        <input type="date" name="start_date" value="{{ emp[2] }}" required class="border px-2 py-1">
      </label>
    </div>
    <div>
      <label class="block">離職日（若無可留空）：
        <input type="date" name="end_date" value="{{ emp[3] }}" class="border px-2 py-1">
      </label>
    </div>

    <!-- 部門／職等 -->
    <div>
      <label class="block">部門：
        <input type="text" name="department" value="{{ emp[4] }}" required class="border px-2 py-1 w-full">
      </label>
    </div>
    <div>
      <label class="block">職等：
        <input type="text" name="job_level" value="{{ emp[5] }}" class="border px-2 py-1 w-full">
      </label>
    </div>

    <!-- 薪資資訊 -->
    <div>
      <label class="block">薪資級距：
        <input type="text" name="salary_grade" value="{{ emp[6] }}" required class="border px-2 py-1 w-full">
      </label>
    </div>
    <div>
      <label class="block">底薪（NTD/月）：
        <input type="number" name="base_salary" value="{{ emp[7] }}" min="0" class="border px-2 py-1 w-full">
      </label>
    </div>
    <div>
      <label class="block">職務津貼（NTD/月）：
        <input type="number" name="position_allowance" value="{{ emp[8] }}" min="0" class="border px-2 py-1 w-full">
      </label>
    </div>

    <!-- 留職停薪 -->
    <div>
      <label class="inline-flex items-center">
        <input type="checkbox" name="suspend" {% if emp[9] %}checked{% endif %} class="mr-2">
        留職停薪
      </label>
    </div>

    <!-- 特休（小時制） -->
    <div class="border rounded p-3">
      <h2 class="font-semibold mb-2">特休（小時）</h2>

      <div class="mb-2">
        <label class="block">已用特休（小時）：
          <input type="number"
                 name="used_leave_hours"
                 step="0.5"
                 min="0"
                 value="{{ emp[13] if emp[13] is not none else ((emp[10] or 0) * 8) }}"
                 class="border px-2 py-1 w-40">
        </label>
      </div>

      <div class="mb-2">
        <label class="block">應有特休（小時，唯讀）：
          <input type="number"
                 step="0.5"
                 readonly
                 value="{{ emp[12] if emp[12] is not none else ((emp[11] or 0) * 8) }}"
                 class="border px-2 py-1 w-40 bg-gray-100">
        </label>
        <div class="text-xs text-gray-500 mt-1">（系統會自動計算，若需個案比例調整，請用下方「特休調整」欄位）</div>
      </div>

      <div>
        <label class="block">特休調整（小時，可正負，0.5 單位）：
          <input type="number"
                 name="leave_adjust_hours"
                 step="0.5"
                 value="{{ emp[14] if emp[14] is not none else 0 }}"
                 class="border px-2 py-1 w-48">
        </label>
        <div class="text-xs text-gray-500 mt-1">例：想把最終應有特休從 24h 改成 16h，請填 -8。</div>
      </div>
    </div>

    <!-- 隱藏假別 -->
    <input type="hidden" name="entitled_sick" value="{{ emp[12] }}">
    <input type="hidden" name="used_sick" value="0">
    <input type="hidden" name="entitled_personal" value="{{ emp[14] }}">
    <input type="hidden" name="used_personal" value="0">
    <input type="hidden" name="entitled_marriage" value="{{ emp[16] }}">
    <input type="hidden" name="used_marriage" value="0">

    <!-- 操作按鈕 -->
    <div>
      <button type="submit" class="px-4 py-2 bg-blue-500 text-white rounded">儲存</button>
      <a href="/" class="ml-4 text-gray-600">取消</a>
    </div>
  </form>
</body>
</html>

